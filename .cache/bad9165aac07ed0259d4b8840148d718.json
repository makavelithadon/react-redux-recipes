{"dependencies":[{"name":"babel-runtime/helpers/slicedToArray","loc":{"line":1,"column":27}},{"name":"babel-runtime/helpers/extends","loc":{"line":2,"column":21}},{"name":"babel-runtime/helpers/classCallCheck","loc":{"line":3,"column":28}},{"name":"babel-runtime/helpers/createClass","loc":{"line":4,"column":25}},{"name":"babel-runtime/helpers/possibleConstructorReturn","loc":{"line":5,"column":39}},{"name":"babel-runtime/helpers/inherits","loc":{"line":6,"column":22}},{"name":"lodash/invoke","loc":{"line":7,"column":20}},{"name":"lodash/forEach","loc":{"line":8,"column":21}},{"name":"lodash/without","loc":{"line":9,"column":21}},{"name":"lodash/includes","loc":{"line":10,"column":22}},{"name":"prop-types","loc":{"line":12,"column":22}},{"name":"react","loc":{"line":13,"column":33}},{"name":"../../lib","loc":{"line":15,"column":113}}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var e=require(\"babel-runtime/helpers/slicedToArray\"),t=y(e),s=require(\"babel-runtime/helpers/extends\"),n=y(s),o=require(\"babel-runtime/helpers/classCallCheck\"),a=y(o),i=require(\"babel-runtime/helpers/createClass\"),r=y(i),l=require(\"babel-runtime/helpers/possibleConstructorReturn\"),c=y(l),u=require(\"babel-runtime/helpers/inherits\"),p=y(u),d=require(\"lodash/invoke\"),f=y(d),b=require(\"lodash/forEach\"),h=y(b),m=require(\"lodash/without\"),v=y(m),P=require(\"lodash/includes\"),g=y(P),k=require(\"prop-types\"),V=y(k),O=require(\"react\"),R=y(O),w=require(\"../../lib\");function y(e){return e&&e.__esModule?e:{default:e}}var S=function(e){(0,p.default)(s,e);function s(){var e,t,o,i;(0,a.default)(this,s);for(var r=arguments.length,l=Array(r),u=0;u<r;u++)l[u]=arguments[u];return t=o=(0,c.default)(this,(e=s.__proto__||Object.getPrototypeOf(s)).call.apply(e,[this].concat(l))),o.calculations={bottomPassed:!1,bottomVisible:!1,fits:!1,passing:!1,offScreen:!1,onScreen:!1,topPassed:!1,topVisible:!1},o.firedCallbacks=[],o.fire=function(e,t){var s=e.callback,n=e.name,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=o.props,r=i.continuous,l=i.once,c=o.calculations[t]!==a,u=r||o.calculations[t]!==o.oldCalculations[t];c&&u&&o.execute(s,n),l||(o.firedCallbacks=(0,v.default)(o.firedCallbacks,n))},o.handleUpdate=function(){o.ticking||(o.ticking=!0,requestAnimationFrame(o.update))},o.update=function(){o.ticking=!1,o.oldCalculations=o.calculations,o.calculations=o.computeCalculations(),o.pageYOffset=window.pageYOffset;var e=o.props,t=e.onBottomPassed,s=e.onBottomPassedReverse,a=e.onBottomVisible,i=e.onBottomVisibleReverse,r=e.onPassing,l=e.onPassingReverse,c=e.onTopPassed,u=e.onTopPassedReverse,p=e.onTopVisible,d=e.onTopVisibleReverse,b={bottomPassed:{callback:t,name:\"onBottomPassed\"},bottomVisible:{callback:a,name:\"onBottomVisible\"},passing:{callback:r,name:\"onPassing\"},offScreen:{callback:e.onOffScreen,name:\"onOffScreen\"},onScreen:{callback:e.onOnScreen,name:\"onOnScreen\"},topPassed:{callback:c,name:\"onTopPassed\"},topVisible:{callback:p,name:\"onTopVisible\"}},m={bottomPassed:{callback:s,name:\"onBottomPassedReverse\"},bottomVisible:{callback:i,name:\"onBottomVisibleReverse\"},passing:{callback:l,name:\"onPassingReverse\"},topPassed:{callback:u,name:\"onTopPassedReverse\"},topVisible:{callback:d,name:\"onTopVisibleReverse\"}};(0,f.default)(o.props,\"onUpdate\",null,(0,n.default)({},o.props,{calculations:o.calculations})),o.fireOnPassed(),(0,h.default)(m,function(e,t){return o.fire(e,t,!0)}),(0,h.default)(b,function(e,t){return o.fire(e,t)})},o.handleRef=function(e){return o.ref=e},i=t,(0,c.default)(o,i)}return(0,r.default)(s,[{key:\"componentWillReceiveProps\",value:function(e){var t=e.continuous,s=e.once;(t!==this.props.continuous||s!==this.props.once)&&(this.firedCallbacks=[])}},{key:\"componentDidMount\",value:function(){if((0,w.isBrowser)()){var e=this.props,t=e.context,s=e.fireOnMount;this.pageYOffset=window.pageYOffset,w.eventStack.sub(\"resize\",this.handleUpdate,{target:t}),w.eventStack.sub(\"scroll\",this.handleUpdate,{target:t}),s&&this.update()}}},{key:\"componentWillUnmount\",value:function(){var e=this.props.context;w.eventStack.unsub(\"resize\",this.handleUpdate,{target:e}),w.eventStack.unsub(\"scroll\",this.handleUpdate,{target:e})}},{key:\"execute\",value:function(e,t){var s=this.props.continuous;e&&(!s&&(0,g.default)(this.firedCallbacks,t)||(e(null,(0,n.default)({},this.props,{calculations:this.calculations})),this.firedCallbacks.push(t)))}},{key:\"fireOnPassed\",value:function(){var e=this,t=this.calculations,s=t.percentagePassed,n=t.pixelsPassed,o=this.props.onPassed;(0,h.default)(o,function(t,o){var a=Number(o);if(a&&n>=a)e.execute(t,o);else{var i=(\"\"+o).match(/^(\\d+)%$/);if(i){var r=Number(i[1])/100;s>=r&&e.execute(t,o)}}})}},{key:\"computeCalculations\",value:function(){var e=this.props.offset,s=this.ref.getBoundingClientRect(),n=s.bottom,o=s.height,a=s.top,i=s.width,r=(0,w.normalizeOffset)(e),l=(0,t.default)(r,2),c=l[0],u=l[1],p=window.pageYOffset>this.pageYOffset?\"down\":\"up\",d=a<c,f=n<u,b=f?0:Math.max(-1*a,0),h=b/o,m=n>=u&&n<=window.innerHeight,v=a>=c&&a<=window.innerHeight,P=(v||d)&&!f;return{bottomPassed:f,bottomVisible:m,direction:p,fits:v&&m,height:o,passing:d&&!f,percentagePassed:h,pixelsPassed:b,offScreen:!P,onScreen:P,topPassed:d,topVisible:v,width:i}}},{key:\"render\",value:function(){var e=this.props.children,t=(0,w.getElementType)(s,this.props),o=(0,w.getUnhandledProps)(s,this.props);return R.default.createElement(t,(0,n.default)({},o,{ref:this.handleRef}),e)}}]),s}(O.Component);S.defaultProps={context:(0,w.isBrowser)()?window:null,continuous:!1,offset:[0,0],once:!0},S._meta={name:\"Visibility\",type:w.META.TYPES.BEHAVIOR},S.handledProps=[\"as\",\"children\",\"context\",\"continuous\",\"fireOnMount\",\"offset\",\"onBottomPassed\",\"onBottomPassedReverse\",\"onBottomVisible\",\"onBottomVisibleReverse\",\"onOffScreen\",\"onOnScreen\",\"onPassed\",\"onPassing\",\"onPassingReverse\",\"onTopPassed\",\"onTopPassedReverse\",\"onTopVisible\",\"onTopVisibleReverse\",\"onUpdate\",\"once\"],exports.default=S,S.propTypes={};"},"hash":"aa4eb12f5bbb5e000f26942450c86fe8"}